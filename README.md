Поменял подключаемые библиотеки, пути файлов, функции компиляторов и всё такое, всё компилируется. Добавил CMake.

Не был уверен, куда выводить текст об ошибке при неудачном открытии файла, решил выводить в поток ошибок.
